<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="CORE_RECHARGE_HIS">
    <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        <result column="ID" property="id" jdbcType="INTEGER"/>
        <result column="MEMBER_ID" property="memberId" jdbcType="LONG"/>
        <result column="SERIAL_NUM" property="serialNum" jdbcType="VARCHAR"/>
        <result column="MONEY" property="money" jdbcType="DECIMAL"/>
        <result column="CURRENCY" property="currency" jdbcType="CHAR"/>
        <result column="RECHARGE_TIME" property="rechargeTime" jdbcType="TIMESTAMP"/>
        <result column="RECHARGE_NAME" property="rechargeName" jdbcType="VARCHAR"/>
        <result column="ACCOUNT" property="account" jdbcType="VARCHAR"/>
        <result column="BANK_NAME" property="bankName" jdbcType="VARCHAR"/>
        <result column="BANK_ADDRESS" property="bankAddress" jdbcType="VARCHAR"/>
        <result column="RECHARGE_STATUS" property="rechargeStatus" jdbcType="CHAR"/>
        <result column="RECHARGE_TYPE" property="rechargeType" jdbcType="CHAR"/>
        <result column="INVOICE" property="invoice" jdbcType="CHAR"/>
        <result column="PAY_BANK_NAME" property="payBankName" jdbcType="VARCHAR"/>
        <result column="PAY_BANK_ADDR" property="payBankAddr" jdbcType="VARCHAR"/>
        <result column="PAYER_NAME" property="payerName" jdbcType="VARCHAR"/>
        <result column="PAYER_ACCOUNT" property="payerAccount" jdbcType="VARCHAR"/>
        <result column="PAYER_ADDR" property="payerAddr" jdbcType="VARCHAR"/>
        <result column="AGENT_ADDER_ID" property="agentAdderId" jdbcType="INTEGER"/>
        <result column="REMARK" property="remark" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- 根据代理商id 查询代理商下所有的充值记录-->
    <select id="selectCoreRechargeHisByAgentAdderId" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="java.util.HashMap">
        select a.ID, a.MEMBER_ID, a.SERIAL_NUM,a.MONEY, a.CURRENCY, a.RECHARGE_TIME, a.RECHARGE_NAME, a.ACCOUNT,
        a.BANK_NAME, a.BANK_ADDRESS, a.RECHARGE_STATUS, a.RECHARGE_TYPE, a.INVOICE, a.PAY_BANK_NAME,
        a.PAY_BANK_ADDR, a.PAYER_NAME, a.PAYER_ACCOUNT, a.PAYER_ADDR,a.AGENT_ADDER_ID,b.EMAIL
        from CORE_RECHARGE_HIS as a ,CORE_MEMBER_INFO as b where a.MEMBER_ID=b.MEMBER_ID
        and a.AGENT_ADDER_ID = #agentAdderId:INTEGER#
         <isNotEmpty prepend="AND" property="email">
           b. EMAIL like '%$email$%'
             </isNotEmpty>
    </select>

    <!-- 根据会员id查询会员的充值历史记录
    <select id="selectRechargeHisByAgentAdderId" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="java.lang.Long">
        select ID, MEMBER_ID, SERIAL_NUM as serialNum, MONEY, CURRENCY, RECHARGE_TIME as rechargeTime,RECHARGE_STATUS as rechargeStatus,
        RECHARGE_TYPE as rechargeType, INVOICE as invoice,AGENT_ADDER_ID as agentAdderId  from CORE_RECHARGE_HIS  where
        MEMBER_ID = #memberId:LONG#
    </select>-->
    
     <!-- 根据会员id查询会员的充值历史记录-->
    <select id="selectRechargeHisByAgentAdderId" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        select ID as id, MEMBER_ID, SERIAL_NUM as serialNum, MONEY, CURRENCY, RECHARGE_TIME as rechargeTime,RECHARGE_STATUS as rechargeStatus,
        RECHARGE_TYPE as rechargeType, INVOICE as invoice,AGENT_ADDER_ID as agentAdderId ,REMARK as remark from CORE_RECHARGE_HIS  where
       MEMBER_ID = #memberId# 
       <isEqual compareValue="1" property="rechargeStatus">
         AND (RECHARGE_STATUS=#rechargeStatus#  OR RECHARGE_STATUS='5')
        </isEqual>
        <isNotEqual compareValue="1" property="rechargeStatus">
       AND RECHARGE_STATUS=#rechargeStatus#
        </isNotEqual>
       order by RECHARGE_TIME
       <isEqual compareValue="0" property="desc">
       DESC
       </isEqual>  
      <isEqual compareValue="2" property="desc">
        ASC
       </isEqual> 
       <isNotEmpty property="fromRecord">
      limit $fromRecord$,$pageSize$
    </isNotEmpty>
    </select>
     <!-- 后台查询会员的充值历史记录in($rechargeStatus$)-->
    <select id="queryRechargeHisListPlatForm" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        select A.ID as id, A.MEMBER_ID, B.EMAIL AS email,A.SERIAL_NUM as serialNum, A.MONEY, A.CURRENCY, A.RECHARGE_TIME as rechargeTime,A.RECHARGE_STATUS as rechargeStatus,
        A.RECHARGE_TYPE as rechargeType, A.INVOICE as invoice,A.AGENT_ADDER_ID as agentAdderId ,A.REMARK as remark from CORE_RECHARGE_HIS A left join CORE_MEMBER_INFO B ON A.MEMBER_ID = B.MEMBER_ID  where
       RECHARGE_STATUS =#rechargeStatus# 
       <isNotNull  property="memberId"  prepend="AND">
         A.MEMBER_ID = #memberId#
        </isNotNull>
       order by RECHARGE_TIME 
       <isEqual compareValue="0" property="desc">
       ASC
       </isEqual>  
      <isEqual compareValue="2" property="desc">
        DESC
       </isEqual> 
       <isNotEmpty property="fromRecord">
      limit $fromRecord$,$pageSize$
    </isNotEmpty>
    </select>
	<!--historyRecord-->
   <select id="selectRechargeHisBySerialNum" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="string">
        select ID, MEMBER_ID as memberId , SERIAL_NUM as serialNum , MONEY, CURRENCY, RECHARGE_TIME as rechargeTime,RECHARGE_STATUS as  rechargeStatus ,
        RECHARGE_TYPE as rechargeType  from CORE_RECHARGE_HIS  where
        SERIAL_NUM = #serialNum:VARCHAR#
    </select>
	<!--selectListHistoryRecord -->
	<select id="selectAllOrderByTime" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="map">
        select ID as id, MEMBER_ID as memberId , SERIAL_NUM as serialNum , MONEY, CURRENCY, RECHARGE_TIME as rechargeTime,RECHARGE_STATUS as  rechargeStatus ,
        RECHARGE_TYPE as rechargeType ,REMARK as remark from CORE_RECHARGE_HIS  where
        MEMBER_ID = #memberId:VARCHAR#
         <isNotNull prepend="AND" property="status">
          RECHARGE_STATUS=#status#
        </isNotNull>
       
        <isEqual compareValue="1" property="status">
         AND (RECHARGE_STATUS=#status# OR RECHARGE_STATUS='5')
        </isEqual>
		<dynamic prepend=" order by ">
       
        <isNotEmpty property="descFlag">
           RECHARGE_TIME   DESC
        </isNotEmpty>
        <isNotEmpty property="asceFlag">
           RECHARGE_TIME ASC
        </isNotEmpty>
    </dynamic>
      <isNotEmpty property="fromRecord">
      limit $fromRecord$,$pageSize$
    </isNotEmpty>

    </select>

     <!-- 根据会员id查询会员的充值历史记录
    <select id="selectCountByAgentAdderId" resultClass="java.lang.Long" parameterClass="java.lang.Long">
        select count(*) as count from CORE_RECHARGE_HIS  where
        MEMBER_ID = #memberId:LONG#
    </select>-->
  <!-- 根据会员id查询会员的充值历史记录-->
    <select id="selectCountByAgentAdderId" resultClass="java.lang.Long" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        select count(*) as count from CORE_RECHARGE_HIS  where
        MEMBER_ID = #memberId# 

        <isEqual compareValue="1" property="rechargeStatus">
          AND (RECHARGE_STATUS=#rechargeStatus# OR RECHARGE_STATUS='5')
        </isEqual>
        <isNotEqual compareValue="1" property="rechargeStatus">
          AND RECHARGE_STATUS=#rechargeStatus# 
        </isNotEqual>
    </select>
    <!-- 后台查询会员的充值历史记录-->
    <select id="selectCountPlatForm" resultClass="com.mitian.airad.model.CoreRechargeHis" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        select count(*) as count, SUM(MONEY) AS money from CORE_RECHARGE_HIS  where  RECHARGE_STATUS =#rechargeStatus#
        <isNotNull  property="memberId"  prepend="AND">
         MEMBER_ID = #memberId#
        </isNotNull>
    </select>
    <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        select ID, MEMBER_ID, SERIAL_NUM, MONEY, CURRENCY, RECHARGE_TIME, RECHARGE_NAME, ACCOUNT,
        BANK_NAME, BANK_ADDRESS, RECHARGE_STATUS, RECHARGE_TYPE, INVOICE, PAY_BANK_NAME,
        PAY_BANK_ADDR, PAYER_NAME, PAYER_ACCOUNT, PAYER_ADDR,AGENT_ADDER_ID
        from CORE_RECHARGE_HIS
        where ID = #id:INTEGER#
    </select>
    <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        delete from CORE_RECHARGE_HIS
        where ID = #id:INTEGER#
    </delete>
    <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        insert into CORE_RECHARGE_HIS (ID, MEMBER_ID, SERIAL_NUM, MONEY, CURRENCY, RECHARGE_TIME,
        RECHARGE_NAME, ACCOUNT, BANK_NAME, BANK_ADDRESS, RECHARGE_STATUS, RECHARGE_TYPE, INVOICE,
        PAY_BANK_NAME, PAY_BANK_ADDR, PAYER_NAME, PAYER_ACCOUNT, PAYER_ADDR,AGENT_ADDER_ID)
        values (#id:INTEGER#, #memberId:LONG#, #serialNum:VARCHAR#, #money:DECIMAL#, #currency:CHAR#,
        #rechargeTime:TIMESTAMP#, #rechargeName:VARCHAR#, #account:VARCHAR#, #bankName:VARCHAR#,
        #bankAddress:VARCHAR#, #rechargeStatus:CHAR#, #rechargeType:CHAR#, #invoice:CHAR#,
        #payBankName:VARCHAR#, #payBankAddr:VARCHAR#, #payerName:VARCHAR#, #payerAccount:VARCHAR#,
        #payerAddr:VARCHAR#,#agentAdderId:INTEGER#)
    </insert>
    <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        insert into CORE_RECHARGE_HIS
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                ID
            </isNotNull>
            <isNotNull prepend="," property="memberId">
                MEMBER_ID
            </isNotNull>
            <isNotNull prepend="," property="serialNum">
                SERIAL_NUM
            </isNotNull>
            <isNotNull prepend="," property="money">
                MONEY
            </isNotNull>
            <isNotNull prepend="," property="currency">
                CURRENCY
            </isNotNull>
            <isNotNull prepend="," property="rechargeTime">
                RECHARGE_TIME
            </isNotNull>
            <isNotNull prepend="," property="rechargeName">
                RECHARGE_NAME
            </isNotNull>
            <isNotNull prepend="," property="account">
                ACCOUNT
            </isNotNull>
            <isNotNull prepend="," property="bankName">
                BANK_NAME
            </isNotNull>
            <isNotNull prepend="," property="bankAddress">
                BANK_ADDRESS
            </isNotNull>
            <isNotNull prepend="," property="rechargeStatus">
                RECHARGE_STATUS
            </isNotNull>
            <isNotNull prepend="," property="rechargeType">
                RECHARGE_TYPE
            </isNotNull>
            <isNotNull prepend="," property="invoice">
                INVOICE
            </isNotNull>
            <isNotNull prepend="," property="payBankName">
                PAY_BANK_NAME
            </isNotNull>
            <isNotNull prepend="," property="payBankAddr">
                PAY_BANK_ADDR
            </isNotNull>
            <isNotNull prepend="," property="payerName">
                PAYER_NAME
            </isNotNull>
            <isNotNull prepend="," property="payerAccount">
                PAYER_ACCOUNT
            </isNotNull>
            <isNotNull prepend="," property="payerAddr">
                PAYER_ADDR
            </isNotNull>
            <isNotNull prepend="," property="agentAdderId">
                AGENT_ADDER_ID
            </isNotNull>
            <isNotNull prepend="," property="remark">
                REMARK
            </isNotNull>
            )
        </dynamic>
        values
        <dynamic prepend="(">
            <isNotNull prepend="," property="id">
                #id:INTEGER#
            </isNotNull>
            <isNotNull prepend="," property="memberId">
                #memberId:LONG#
            </isNotNull>
            <isNotNull prepend="," property="serialNum">
                #serialNum:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="money">
                #money:DECIMAL#
            </isNotNull>
            <isNotNull prepend="," property="currency">
                #currency:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeTime">
                #rechargeTime:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="rechargeName">
                #rechargeName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="account">
                #account:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="bankName">
                #bankName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="bankAddress">
                #bankAddress:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeStatus">
                #rechargeStatus:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeType">
                #rechargeType:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="invoice">
                #invoice:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="payBankName">
                #payBankName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payBankAddr">
                #payBankAddr:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerName">
                #payerName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerAccount">
                #payerAccount:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerAddr">
                #payerAddr:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="agentAdderId">
                #agentAdderId:INTEGER#
            </isNotNull>
            <isNotNull prepend="," property="remark">
                #remark#
            </isNotNull>
            )
        </dynamic>
    </insert>
     <update id="ibatorgenerated_updateByStatus" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        update CORE_RECHARGE_HIS set RECHARGE_STATUS = #rechargeStatus# 
        where ID = #id#
    </update>
    <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        update CORE_RECHARGE_HIS
        <dynamic prepend="set">
            <isNotNull prepend="," property="memberId">
                MEMBER_ID = #memberId:LONG#
            </isNotNull>
            <isNotNull prepend="," property="serialNum">
                SERIAL_NUM = #serialNum:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="money">
                MONEY = #money:DECIMAL#
            </isNotNull>
            <isNotNull prepend="," property="currency">
                CURRENCY = #currency:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeTime">
                RECHARGE_TIME = #rechargeTime:TIMESTAMP#
            </isNotNull>
            <isNotNull prepend="," property="rechargeName">
                RECHARGE_NAME = #rechargeName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="account">
                ACCOUNT = #account:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="bankName">
                BANK_NAME = #bankName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="bankAddress">
                BANK_ADDRESS = #bankAddress:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeStatus">
                RECHARGE_STATUS = #rechargeStatus:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="rechargeType">
                RECHARGE_TYPE = #rechargeType:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="invoice">
                INVOICE = #invoice:CHAR#
            </isNotNull>
            <isNotNull prepend="," property="payBankName">
                PAY_BANK_NAME = #payBankName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payBankAddr">
                PAY_BANK_ADDR = #payBankAddr:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerName">
                PAYER_NAME = #payerName:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerAccount">
                PAYER_ACCOUNT = #payerAccount:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="payerAddr">
                PAYER_ADDR = #payerAddr:VARCHAR#
            </isNotNull>
            <isNotNull prepend="," property="agentAdderId">
                AGENT_ADDER_ID=#agentAdderId:INTEGER#
            </isNotNull>
        </dynamic>
        where SERIAL_NUM = #serialNum:VARCHAR#
    </update>
    <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.CoreRechargeHis">
        <!--
        WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
        This element was generated on Thu Jan 27 09:21:17 CST 2011.
        -->
        update CORE_RECHARGE_HIS
        set MEMBER_ID = #memberId:LONG#,
        SERIAL_NUM = #serialNum:VARCHAR#,
        MONEY = #money:DECIMAL#,
        CURRENCY = #currency:CHAR#,
        RECHARGE_TIME = #rechargeTime:TIMESTAMP#,
        RECHARGE_NAME = #rechargeName:VARCHAR#,
        ACCOUNT = #account:VARCHAR#,
        BANK_NAME = #bankName:VARCHAR#,
        BANK_ADDRESS = #bankAddress:VARCHAR#,
        RECHARGE_STATUS = #rechargeStatus:CHAR#,
        RECHARGE_TYPE = #rechargeType:CHAR#,
        INVOICE = #invoice:CHAR#,
        PAY_BANK_NAME = #payBankName:VARCHAR#,
        PAY_BANK_ADDR = #payBankAddr:VARCHAR#,
        PAYER_NAME = #payerName:VARCHAR#,
        PAYER_ACCOUNT = #payerAccount:VARCHAR#,
        PAYER_ADDR = #payerAddr:VARCHAR#,
        AGENT_ADDER_ID=#agentAdderId:INTEGER#
        where ID = #id:INTEGER#
    </update>
    <update id="cancelRechargeOrder"  parameterClass="com.mitian.airad.model.CoreRechargeHis">
    update CORE_RECHARGE_HIS set RECHARGE_STATUS= #rechargeStatus:CHAR# where MEMBER_ID=#memberId:LONG# and SERIAL_NUM=#serialNum:VARCHAR#
    </update>
    <select id="getCoreRechargeHisByOrderIdAndMemberId" parameterClass="com.mitian.airad.model.CoreRechargeHis" resultClass="com.mitian.airad.model.CoreRechargeHis">
    select ID, MEMBER_ID as memberId , SERIAL_NUM as serialNum , MONEY, CURRENCY, RECHARGE_TIME as rechargeTime,RECHARGE_STATUS as  rechargeStatus,
        RECHARGE_TYPE as rechargeType  from CORE_RECHARGE_HIS  where
        SERIAL_NUM = #serialNum:VARCHAR# and MEMBER_ID = #memberId:LONG#
    </select>
</sqlMap>
