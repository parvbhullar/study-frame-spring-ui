<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="ACC_INCOME" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:24 CST 2011.
    -->
    <result column="INCOME_ID" property="incomeId" jdbcType="INTEGER" />
    <result column="GUIDE_ID" property="guideId" jdbcType="INTEGER" />
    <result column="OFFER" property="offer" jdbcType="DECIMAL" />
    <result column="INCOME_TYPE" property="incomeType" jdbcType="CHAR" />
    <result column="INCOME_FORMULA" property="incomeFormula" jdbcType="VARCHAR" />
    <result column="REQ_TIME" property="reqTime" jdbcType="TIMESTAMP" />
    <result column="APP_CODE" property="appCode" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ibatorgenerated_BaseResultMap_ext_advertiser" class="com.mitian.airad.model.AccIncome">
    <result column="APP_NAME" jdbcType="VARCHAR" property="appName" />
    <result column="sumOffer" property="sumOffer" jdbcType="DECIMAL" />
  </resultMap> 
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:24 CST 2011.
    -->
    select INCOME_ID, GUIDE_ID, OFFER, INCOME_TYPE, INCOME_FORMULA, REQ_TIME, APP_CODE
    from ACC_INCOME
    where INCOME_ID = #incomeId:INTEGER#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:24 CST 2011.
    -->
    delete from ACC_INCOME
    where INCOME_ID = #incomeId:INTEGER#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:25 CST 2011.
    -->
    insert into ACC_INCOME (INCOME_ID, GUIDE_ID, OFFER, INCOME_TYPE, INCOME_FORMULA, REQ_TIME,
      APP_CODE)
    values (#incomeId:INTEGER#, #guideId:INTEGER#, #offer:DECIMAL#, #incomeType:CHAR#,
      #incomeFormula:VARCHAR#, #reqTime:TIMESTAMP#, #appCode:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:25 CST 2011.
    -->
    insert into ACC_INCOME
    <dynamic prepend="(" >
      <isNotNull prepend="," property="incomeId" >
        INCOME_ID
      </isNotNull>
      <isNotNull prepend="," property="guideId" >
        GUIDE_ID
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER
      </isNotNull>
      <isNotNull prepend="," property="incomeType" >
        INCOME_TYPE
      </isNotNull>
      <isNotNull prepend="," property="incomeFormula" >
        INCOME_FORMULA
      </isNotNull>
      <isNotNull prepend="," property="reqTime" >
        REQ_TIME
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        APP_CODE
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="incomeId" >
        #incomeId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="guideId" >
        #guideId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="incomeType" >
        #incomeType:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="incomeFormula" >
        #incomeFormula:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reqTime" >
        #reqTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        #appCode:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:25 CST 2011.
    -->
    update ACC_INCOME
    <dynamic prepend="set" >
      <isNotNull prepend="," property="guideId" >
        GUIDE_ID = #guideId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER = #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="incomeType" >
        INCOME_TYPE = #incomeType:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="incomeFormula" >
        INCOME_FORMULA = #incomeFormula:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reqTime" >
        REQ_TIME = #reqTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        APP_CODE = #appCode:VARCHAR#
      </isNotNull>
    </dynamic>
    where INCOME_ID = #incomeId:INTEGER#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.AccIncome" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 02 13:45:25 CST 2011.
    -->
    update ACC_INCOME
    set GUIDE_ID = #guideId:INTEGER#,
      OFFER = #offer:DECIMAL#,
      INCOME_TYPE = #incomeType:CHAR#,
      INCOME_FORMULA = #incomeFormula:VARCHAR#,
      REQ_TIME = #reqTime:TIMESTAMP#,
      APP_CODE = #appCode:VARCHAR#
    where INCOME_ID = #incomeId:INTEGER#
  </update>
  <!-- 查询所有分页（应用收益） -->
  <select id="selectAll" resultMap="ibatorgenerated_BaseResultMap_ext_advertiser" parameterClass="java.util.HashMap">
      select C.APP_NAME,IFNULL(SUM(A.OFFER),0) as sumOffer from ACC_INCOME A
      INNER JOIN CORE_APP C
      ON C.APP_CODE = A.APP_CODE WHERE C.MEMBER_ID =#memberId# group by C.APP_NAME
 </select>
   <!-- 查找总条数 -->
  <select id="selectAllCount"  resultClass="int" parameterClass="java.lang.Long">
     SELECT COUNT(*) FROM (select C.APP_NAME,IFNULL(SUM(A.OFFER),0) as sumOffer,C.APP_CODE  from ACC_INCOME A
      INNER JOIN CORE_APP C
      ON C.APP_CODE = A.APP_CODE WHERE C.MEMBER_ID =#memberId# group by C.APP_NAME)t
  </select>
</sqlMap>