<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap>
	<typeAlias alias="communicationBean" type="com.ivyinfo.communication.bean.CommunicationBean" />
	<!-- 查找所有的通讯录 -->
	<select id="findAllCommunication" parameterClass="map" resultClass="communicationBean">
		<![CDATA[
			SELECT a.*,b.groupname as imgroupname
			FROM $logname$_t_communication a
			LEFT JOIN $logname$_t_communication_group b ON a.imgroupid = b.id
		]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id">
				ID = #id#
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="order by">
			<isNotNull property="order">
				$order$ $orderby$
			</isNotNull>
		</dynamic>
		<dynamic prepend="limit">
			<isNotNull property="from">
				#from#,#len#
			</isNotNull>
		</dynamic>
	</select>
	
	<!-- 新增通讯录 -->
	<insert id="saveCommunication" parameterClass="communicationBean">
		<![CDATA[
			INSERT INTO $logname$_t_communication(id,name,namepy,alias,sex,birthday,email,
				companyname,companyaddress,companypostcode,familyaddress,familypostcode,phone,remark,
				imgroupid,isimtype,ismailtype,iswebcalltype,timestemp)
			VALUES(#id#,#name#,#namepy#,#alias#,#sex#,#birthday#,#email#,
				#companyname#,#companyaddress#,#companypostcode#,#familyaddress#,#familypostcode#,#phone#,#remark#,
				#imgroupid#,#isimtype#,#ismailtype#,#iswebcalltype#,#timestemp#)
		]]>
	</insert>
	
	<!-- 修改通讯录信息 -->
	<update id="updateCommunication" parameterClass="communicationBean">
		<![CDATA[
			UPDATE $logname$_t_communication SET 
			name=#name#,namepy=#namepy#,alias=#alias#,sex=#sex#,birthday=#birthday#,email=#email#,companyname=#companyname#,
			companyaddress=#companyaddress#,companypostcode=#companypostcode#,familyaddress=#familyaddress#,
			familypostcode=#familypostcode#,phone=#phone#,remark=#remark#,imgroupid=#imgroupid#
			isimtype=#isimtype#,ismailtype=#ismailtype#,iswebcalltype=#iswebcalltype#
			timestemp=#timestemp#
			WHERE id=#id#
		]]>
	</update>
	
	<!-- 删除通讯录信息 -->
	<delete id="deleteCommunication" parameterClass="map">
		<![CDATA[
			DELETE FROM $logname$_t_communication
		]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="id">
				ID = #id#
			</isNotEmpty>
		</dynamic>
	</delete>
	
	<statement id="CommunicationTable" parameterClass="String">
        create table $logname$_t_communication
		(
		    id                   int                            not null,
		    name                 varchar(50),
		    namepy               varchar(50),
		    alias                varchar(50),
		    sex                  varchar(10),
		    birthday             varchar(20),
		    email                varchar(50),
		    companyname          varchar(200),
		    companyaddress       varchar(200),
		    companypostcode      varchar(10),
		    familyaddress        varchar(200),
		    familypostcode       varchar(10),
		    phone                varchar(20),
		    remark               varchar(300),
		    imgroupid            varchar(20),
		    isimtype             varchar(20),
		    ismailtype           varchar(20),
		    iswebcalltype        varchar(20),
		    timestemp            varchar(20),
		    remark1               varchar(50),
		    remark2               varchar(50),
		    remark3               varchar(50),
		    remark4               varchar(50),
		    remark5               varchar(50),
		    PRIMARY KEY  (id)
		)ENGINE=MyISAM DEFAULT CHARSET=gbk;
	</statement> 
	
	<statement id="DropCommunicationTable" parameterClass="String">
		DROP TABLE $logname$_t_communication;
	</statement>
</sqlMap>