(function(a,b){function w(b){var c=this;c.owner=b,c._draggable=new e(b.wrapper,{filter:i,group:b.wrapper.id+"-moving",dragstart:a.proxy(c.dragstart,c),drag:a.proxy(c.drag,c),dragend:a.proxy(c.dragend,c)})}function v(b){var c=this;c.owner=b,c._draggable=new e(b.wrapper,{filter:".t-resize-handle",group:b.wrapper.id+"-resizing",dragstart:a.proxy(c.dragstart,c),drag:a.proxy(c.drag,c),dragend:a.proxy(c.dragend,c)})}function u(b,c){var d=a(b);typeof c.scrollable!="undefined"&&c.scrollable===!1&&d.attr("style","overflow:hidden;"),c.contentUrl&&!q(c.contentUrl)&&d.html(t.iframe(c)),a(t.wrapper(c)).append(t.titlebar(c)).append(d).appendTo(document.body)}function r(b){a.browser.msie&&a.browser.version<7&&b.find(".t-resize-e,.t-resize-w").css("height",b.height()).end().find(".t-resize-n,.t-resize-s").css("width",b.width()).end().find(j).css({width:b.width(),height:b.height()})}function q(a){return a&&!/^([a-z]+:)?\/\//i.test(a)}var c=b.kendo,d=c.ui.Component,e=c.ui.Draggable,f=c.fx,g=c.template,h=".t-window",i=".t-window-titlebar",j=".t-overlay",k="open",l="activate",m="close",n="refresh",o="resize",p="error",s=d.extend({init:function(c,e){var f=this,g,j=".t-window-titlebar .t-window-action",s,x,y=!1;d.fn.init.call(f,c,e),e=f.options,c=f.element,c.parent().is("body")||(c.is(":visible")?(x=c.offset(),y=!0):(c.css({visibility:"hidden",display:""}),x=c.offset())),g=f.wrapper=c.closest(h);if(!c.is(".t-content")||!g[0])c.addClass("t-window-content t-content"),u(c,e),g=f.wrapper=c.closest(h),s=f.wrapper.find(i),s.css("margin-top",-s.outerHeight()),g.css("padding-top",s.outerHeight()),e.width&&g.width(e.width),e.height&&g.height(e.height),e.visible||g.hide();x&&(y?g.css({top:x.top,left:x.left}):g.css({top:x.top,left:x.left,visibility:"visible",display:"none"})),g.toggleClass("t-rtl",f.wrapper.closest(".t-rtl").length>0).appendTo(document.body),e.modal&&f._overlay(g.is(":visible")).css({opacity:.5}),g.delegate(j,"mouseenter",function(){a(this).addClass("t-state-hover")}).delegate(j,"mouseleave",function(){a(this).removeClass("t-state-hover")}).delegate(j,"click",a.proxy(f._windowActionHandler,f)),e.resizable&&(g.delegate(i,"dblclick",a.proxy(f.toggleMaximization,f)),a.each("n e s w se sw ne nw".split(" "),function(a,b){g.append(t.resizeHandle(b))}),r(f.wrapper),f.resizing=new v(f)),e.draggable&&(f.dragging=new w(f)),f.bind([k,l,m,n,o,p],e),a(b).resize(a.proxy(f._onDocumentResize,f)),q(e.contentUrl)&&f._ajaxRequest(e.contentUrl),g.is(":visible")&&(f.trigger(k),f.trigger(l))},options:{animation:{open:{effects:{zoomIn:{},fadeIn:{}},duration:350,show:!0},close:{effects:{zoomOut:{properties:{scale:.7}},fadeOut:{}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:50,minHeight:50,visible:!0},_overlay:function(b){var c=a("body > .t-overlay"),d=a(document),e=this.wrapper[0];c.length==0?c=a("<div class='t-overlay' />").toggle(b).insertBefore(e):c.insertBefore(e).toggle(b),a.browser.msie&&a.browser.version<7&&c.css({width:d.width()-21,height:d.height(),position:"absolute"});return c},_windowActionHandler:function(b){var c=a(b.target).closest(".t-window-action").find(".t-icon"),d=this;a.each({"t-close":d.close,"t-maximize":d.maximize,"t-restore":d.restore,"t-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var c=this.wrapper,d=a(b);c.css({left:d.scrollLeft()+Math.max(0,(d.width()-c.width())/2),top:d.scrollTop()+Math.max(0,(d.height()-c.height())/2)});return this},title:function(b){var c=a(".t-window-titlebar > .t-window-title",this.wrapper);if(!b)return c.text();c.text(b);return this},content:function(b){var c=a("> .t-window-content",this.wrapper);if(!b)return c.html();c.html(b);return this},open:function(){var b=this,c=b.wrapper,d=b.options.animation.open;if(!b.trigger(k)){if(b.options.modal){var e=b._overlay(!1);d.duration?e.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:.5}}},duration:d.duration,show:!0}):e.css("opacity",.5).show()}c.is(":visible")||c.show().kendoStop().kendoAnimate({effects:d.effects,duration:d.duration,complete:function(){b.trigger(l)}})}b.options.isMaximized&&a("html, body").css("overflow","hidden");return b},close:function(){var b=this,c=b.wrapper,d=b.options,e=d.animation.close;if(c.is(":visible")&&!b.trigger(m)){function f(a){return a.find(".t-window-content").data("kendoWindow")}var g=a(h).filter(function(){var b=a(this);return b.is(":visible")&&f(b).options.modal}),i=d.modal&&g.length==1,j=d.modal?b._overlay(!0):a(undefined);i?e.duration?j.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:0}}},duration:e.duration,hide:!0}):j.hide():g.length>0&&f(g.eq(g.length-2))._overlay(!0),c.kendoStop().kendoAnimate({effects:e.effects,duration:e.duration,complete:function(){c.hide()}})}b.options.isMaximized&&a("html, body").css("overflow","");return b},toggleMaximization:function(b){b&&a(b.target).closest(".t-window-action").length>0||this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this;if(!!b.options.isMaximized){b.wrapper.css({position:"absolute",left:b.restorationSettings.left,top:b.restorationSettings.top,width:b.restorationSettings.width,height:b.restorationSettings.height}).find(".t-resize-handle").show().end().find(".t-window-titlebar .t-restore").addClass("t-maximize").removeClass("t-restore"),a("html, body").css("overflow",""),b.options.isMaximized=!1,b.trigger(o);return b}},maximize:function(b){var c=this;if(!c.options.isMaximized){var d=c.wrapper;c.restorationSettings={left:d.position().left,top:d.position().top,width:d.width(),height:d.height()},d.css({left:0,top:0,position:"fixed"}).find(".t-resize-handle").hide().end().find(".t-window-titlebar .t-maximize").addClass("t-restore").removeClass("t-maximize"),a("html, body").css("overflow","hidden"),c.options.isMaximized=!0,c._onDocumentResize();return c}},_onDocumentResize:function(){if(!!this.options.isMaximized){var c=this.wrapper;c.css({width:a(b).width(),height:a(b).height()}),r(c),this.trigger(o)}},refresh:function(a){var b=this;a=a||b.options.contentUrl,q(a)&&b._ajaxRequest(a);return b},_ajaxRequest:function(b){var c=this,d=setTimeout(function(){a(".t-refresh",c.wrapper).addClass("t-loading")},100),e={};a.ajax({type:"GET",url:b,dataType:"html",data:e,cache:!1,error:a.proxy(function(a,b){c.trigger(p)},c),complete:function(){clearTimeout(d),a(".t-refresh",c.wrapper).removeClass("t-loading")},success:a.proxy(function(b,d){a(".t-window-content",c.wrapper).html(b),c.trigger(n)},c)})},destroy:function(){function c(a){return a.find(".t-window-content").data("kendoWindow")}var b=this;b.wrapper.remove();var d=a(h).filter(function(){var b=a(this);return b.is(":visible")&&c(b).options.modal}),e=b.options.modal&&d.length==0;e?b._overlay(!1).remove():d.length>0&&c(d.eq(d.length-2))._overlay(!0)}}),t={wrapper:g("<div class='t-widget t-window'></div>"),titlebar:g("<div class='t-window-titlebar t-header'>&nbsp;<span class='t-window-title'><#= title #></span><div class='t-window-actions t-header'><# for (var i = 0; i < actions.length; i++) { #><a href='#' class='t-window-action t-link'><span class='t-icon t-<#= actions[i].toLowerCase() #>'><#= actions[i] #></span></a><# } #></div></div>"),iframe:g("<iframe src='<#= contentUrl #>' title='<#= title #>' frameborder='0' style='border:0;width:100%;height:100%;'>This page requires frames in order to show content</iframe>"),resizeHandle:g("<div class='t-resize-handle t-resize-<#= data #>'></div>")};v.prototype={dragstart:function(b){var c=this.owner,d=c.wrapper;c.elementPadding=parseInt(c.wrapper.css("padding-top")),c.initialCursorPosition=d.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("t-resize-handle t-resize-","").split(""),c.initialSize={width:c.wrapper.width(),height:c.wrapper.height()},a("<div class='t-overlay' />").appendTo(c.wrapper),d.find(".t-resize-handle").not(b.currentTarget).hide(),a(document.body).css("cursor",b.currentTarget.css("cursor"))},drag:function(b){var c=this.owner,d=c.wrapper,e={e:function(){var a=b.pageX-c.initialCursorPosition.left;d.width(a<c.options.minWidth?c.options.minWidth:c.options.maxWidth&&a>c.options.maxWidth?c.options.maxWidth:a)},s:function(){var a=b.pageY-c.initialCursorPosition.top-c.elementPadding;d.height(a<c.options.minHeight?c.options.minHeight:c.options.maxHeight&&a>c.options.maxHeight?c.options.maxHeight:a)},w:function(){var a=c.initialCursorPosition.left+c.initialSize.width,e=a-b.pageX;d.css({left:b.pageX>a-c.options.minWidth?a-c.options.minWidth:b.pageX<a-c.options.maxWidth?a-c.options.maxWidth:b.pageX,width:e<c.options.minWidth?c.options.minWidth:c.options.maxWidth&&e>c.options.maxWidth?c.options.maxWidth:e})},n:function(){var a=c.initialCursorPosition.top+c.initialSize.height,e=a-b.pageY;d.css({top:b.pageY>a-c.options.minHeight?a-c.options.minHeight:b.pageY<a-c.options.maxHeight?a-c.options.maxHeight:b.pageY,height:e<c.options.minHeight?c.options.minHeight:c.options.maxHeight&&e>c.options.maxHeight?c.options.maxHeight:e})}};a.each(c.resizeDirection,function(){e[this]()}),r(d),c.trigger(o)},dragend:function(b){var c=this.owner,d=c.wrapper;d.find(j).remove().end().find(".t-resize-handle").not(b.currentTarget).show(),a(document.body).css("cursor",""),b.keyCode==27&&(r(d),d.css(c.initialCursorPosition).css(c.initialSize));return!1}},w.prototype={dragstart:function(b){var c=this.owner;c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.pageX-c.initialWindowPosition.left,top:b.pageY-c.initialWindowPosition.top},a(".t-resize-handle",c.wrapper).hide(),a("<div class='t-overlay' />").appendTo(c.wrapper),a(document.body).css("cursor",b.currentTarget.css("cursor"))},drag:function(b){var c=this.owner,d={left:b.pageX-c.startPosition.left,top:Math.max(b.pageY-c.startPosition.top,0)};a(c.wrapper).css(d)},dragend:function(b){var c=this.owner;c.wrapper.find(".t-resize-handle").show().end().find(j).remove(),a(document.body).css("cursor",""),b.keyCode==27&&b.currentTarget.closest(h).css(c.initialWindowPosition);return!1}},c.ui.plugin("Window",s)})(jQuery,window)