(function(a,b){function Z(b,c){var d=a(b)[0].tBodies[0],e=d?d.rows:[],f,g,h,i=c.length,j=[],k,l,m,n;for(f=0,g=e.length;f<g;f++){l={},n=!0,k=e[f].cells;for(h=0;h<i;h++)m=k[h],m.nodeName.toLowerCase()!=="th"&&(n=!1,l[c[h].field]=m.innerHTML);n||j.push(l)}return j}function Y(b,c){var d=a(b)[0].children,e,f,g=[],h,i;for(e=0,f=d.length;e<f;e++)h={},i=d[e],h[c[0].field]=i.text,h[c[1].field]=i.value,g.push(h);return g}function V(){this._store=window.localStorage}function U(){this._store={}}function R(a,b){var c=new J(a),b=b||{},d=b.aggregates,e=b.filter;e&&(c=c.filter(e));return c.aggregate(d)}function Q(a,c){var d=new J(a),c=c||{},e=c.group,f=K(c.sort||[]).concat(N(e||[])),g,h=c.filter,i=c.skip,j=c.take;h&&(d=d.filter(h),g=d.toArray().length),f&&(d=d.sort(f)),i!==b&&j!==b&&(d=d.range(i,j)),e&&(d=d.group(e,a));return{total:g,data:d.toArray()}}function O(a,b,c,d,e){b=b||[];var f,g,h,i,j=b.length;for(f=0;f<j;f++){g=b[f],h=g.aggregate;var k=g.field;a[k]=a[k]||{},a[k][h]=P[h.toLowerCase()](a[k][h],c,n.accessor(k),d,e)}}function N(a,c){var d=typeof a===s?{field:a,dir:c}:a,e=h(d)?d:d!==b?[d]:[];return k(e,function(a){return{field:a.field,dir:a.dir||"asc",aggregates:a.aggregates}})}function M(a){return a=h(a)?a:[a]}function L(a){if(a)return a=h(a)?a:[a]}function K(a,c){if(a){var d=typeof a===s?{field:a,dir:c}:a,e=h(d)?d:d!==b?[d]:[];return i(e,function(a){return!!a.dir})}}function J(a){this.data=a||[]}var c=a.extend,d=a.proxy,e=a.isFunction,f=a.isPlainObject,g=a.isEmptyObject,h=a.isArray,i=a.grep,j=a.ajax,k,l=a.each,m=a.noop,n=window.kendo,o=n.Observable,p=n.Class,q=n.data.Model,r=n.data.ModelSet,s="string",t="create",u="read",v="update",w="destroy",x="change",y="multiple",z="single",A="error",B="requestStart",C=[t,u,v,w],D=function(a){return a},E=n.getter,F=n.stringify,G=/^\/Date\((.*?)\)\/$/,H={selector:function(a){return e(a)?a:E(a)},asc:function(a){var b=this.selector(a);return function(a,c){a=b(a),c=b(c);return a>c?1:a<c?-1:0}},desc:function(a){var b=this.selector(a);return function(a,c){a=b(a),c=b(c);return a<c?1:a>c?-1:0}},create:function(a){return H[a.dir.toLowerCase()](a.field)},combine:function(a){return function(b,c){var d=a[0](b,c),e,f;for(e=1,f=a.length;e<f;e++)d=d||a[e](b,c);return d}}},I={create:function(a){var b,c,d,e,f,g,h=[],i,j;a=a||[];for(b=0,c=a.length;b<c;b++)d=a[b],typeof d.value===s&&!d.caseSensitive?i=function(a){return a.toLowerCase()}:i=function(a){return a},e=I.selector(d.field,i),f=I.operator(d.operator),g=f(e,i(d.value)),h.push(g);j=I.combine(h);return function(a){return I.execute(j,a)}},selector:function(a,b){if(a){if(e(a))return a;var c=E(a);return function(a){var d=c(a);if(typeof d=="string"){var e=G.exec(d);e&&(d=new Date(parseInt(e[1])))}return b(d)}}return function(a){return b(a)}},execute:function(a,b){var c,d=b.length,e,f=[];for(c=0;c<d;c++)e=b[c],a(e)&&f.push(e);return f},combine:function(a){return function(b){var c=!0,d=0,e=a.length;while(c&&d<e)c=a[d++](b);return c}},operator:function(b){if(!b)return I.eq;if(e(b))return b;b=b.toLowerCase(),operatorStrings=I.operatorStrings;for(var c in operatorStrings)if(a.inArray(b,operatorStrings[c])>-1){b=c;break}return I[b]},operatorStrings:{eq:["eq","==","isequalto","equals","equalto","equal"],neq:["neq","!=","isnotequalto","notequals","notequalto","notequal","not","ne"],lt:["lt","<","islessthan","lessthan","less"],lte:["lte","<=","islessthanorequalto","lessthanequal","le"],gt:["gt",">","isgreaterthan","greaterthan","greater"],gte:["gte",">=","isgreaterthanorequalto","greaterthanequal","ge"],startswith:["startswith"],endswith:["endswith"],contains:["contains","substringof"]},eq:function(a,b){return function(c){var d=a(c);return d>b?!1:b>d?!1:!0}},neq:function(a,b){return function(c){return a(c)!=b}},lt:function(a,b){return function(c){return a(c)<b}},lte:function(a,b){return function(c){return a(c)<=b}},gt:function(a,b){return function(c){return a(c)>b}},gte:function(a,b){return function(c){return a(c)>=b}},startswith:function(a,b){return function(c){return a(c).indexOf(b)==0}},endswith:function(a,b){return function(c){var d=a(c);return d.lastIndexOf(b)==d.length-1}},contains:function(a,b){return function(c){return a(c).indexOf(b)>-1}}};Array.prototype.map!==b?k=function(a,b){return a.map(b)}:k=function(a,b){var c=a.length,d=Array(c);for(var e=0;e<c;e++)d[e]=b(a[e],e,a);return d},J.prototype={toArray:function(){return this.data},range:function(a,b){return new J(this.data.slice(a,a+b))},skip:function(a){return new J(this.data.slice(a))},take:function(a){return new J(this.data.slice(0,a))},select:function(a){return new J(k(this.data,a))},orderBy:function(a){var b=this.data.slice(0),c=e(a)||!a?H.asc(a):a.compare;return new J(b.sort(c))},orderByDescending:function(a){return new J(this.data.slice(0).sort(H.desc(a)))},sort:function(a,b){var c,d,e=K(a,b),f=[];if(e.length){for(c=0,d=e.length;c<d;c++)f.push(H.create(e[c]));return this.orderBy({compare:H.combine(f)})}return this},filter:function(a){var b=I.create(L(a));return new J(b(this.data))},group:function(a,b){a=N(a||[]),b=b||this.data;var c=this,d=new J(c.data),e;a.length>0&&(e=a[0],d=d.groupBy(e).select(function(c){var d=(new J(b)).filter([{field:c.field,operator:"eq",value:c.value}]);return{field:c.field,value:c.value,items:a.length>1?(new J(c.items)).group(a.slice(1),d.toArray()).toArray():c.items,hasSubgroups:a.length>1,aggregates:d.aggregate(e.aggregates)}}));return d},groupBy:function(a){if(g(a)||!this.data.length)return new J([]);var b=a.field,c=this.sort(b,a.dir||"asc").toArray(),d=n.accessor(b),e,f=d.get(c[0],b),h={field:b,value:f,items:[]},i,j,k,l=[h];for(j=0,k=c.length;j<k;j++)e=c[j],i=d.get(e,b),f!==i&&(f=i,h={field:b,value:f,items:[]},l.push(h)),h.items.push(e);return new J(l)},aggregate:function(a){var b,c,d={};if(a&&a.length)for(b=0,c=this.data.length;b<c;b++)O(d,a,this.data[b],b,c);return d}};var P={sum:function(a,b,c){return a=(a||0)+c.get(b)},count:function(a,b,c){return(a||0)+1},average:function(a,b,c,d,e){a=(a||0)+c.get(b),d==e-1&&(a=a/e);return a},max:function(a,b,c){var a=a||0,d=c.get(b);a<d&&(a=d);return a},min:function(a,b,c){var d=c.get(b),a=a||d;a>d&&(a=d);return a}},S=p.extend({init:function(a){this.data=a.data},read:function(a){a.success(this.data)},update:m}),T=p.extend({init:function(a){var b=this,d;a=b.options=c({},b.options,a),l(C,function(b,c){typeof a[c]===s&&(a[c]={url:a[c]})}),b.cache=a.cache?U.create(a.cache):{find:m,add:m},d=a.dialect,b.dialect=e(d)?d:function(a){var b={};l(a,function(a,c){a in d&&(a=d[a],f(a)&&(c=a.value(c),a=a.key)),b[a]=c});return b}},options:{dialect:D},create:function(a){return j(this.setup(a,t))},read:function(c){var d=this,e,f,g,h=d.cache;c=d.setup(c,u),e=c.success||m,f=c.error||m,g=h.find(c.data),g!==b?e(g):(c.success=function(a){h.add(c.data,a),e(a)},a.ajax(c))},update:function(a){return j(this.setup(a,v))},destroy:function(a){return j(this.setup(a,w))},setup:function(a,b){a=a||{};var d=this,f=d.options[b],g=e(f.data)?f.data():f.data;a=c(!0,{},f,a),a.data=d.dialect(c(g,a.data));return a}});U.create=function(a){var b={inmemory:function(){return new U},localstorage:function(){return new V}};if(f(a)&&e(a.find))return a;if(a===!0)return new U;return b[a]()},U.prototype={add:function(a,c){a!==b&&(this._store[F(a)]=c)},find:function(a){return this._store[F(a)]},clear:function(){this._store={}},remove:function(a){delete this._store[F(a)]}},V.prototype={add:function(a,c){a!=b&&this._store.setItem(F(a),F(c))},find:function(b){return a.parseJSON(this._store.getItem(F(b)))},clear:function(){this._store.clear()},remove:function(a){this._store.removeItem(F(a))}};var W=p.extend({init:function(a){var b=this,c,d;a=a||{};for(c in a)d=a[c],b[c]=typeof d===s?E(d):d;f(b.model)&&(b.model=q.define(b.model))},parse:D,data:D,total:function(a){return a.length},groups:D,status:function(a){return a.status},aggregates:function(){return{}}}),X=o.extend({init:function(a){var f=this,h,i,j;a=f.options=c({},f.options,a),c(f,{_map:{},_prefetch:{},_data:[],_ranges:[],_view:[],_pageSize:a.pageSize,_page:a.page||(a.pageSize?1:b),_sort:K(a.sort),_filter:L(a.filter),_group:N(a.group),_aggregates:a.aggregates}),o.fn.init.call(f),j=a.transport,j?(j.read=typeof j.read===s?{url:j.read}:j.read,a.type&&(j=c(!0,{},n.data.transports[a.type],j),a.schema=c(!0,{},n.data.schemas[a.type],a.schema)),f.transport=e(j.read)?j:new T(j)):f.transport=new S({data:a.data}),f.reader=new n.data.readers[a.schema.type||"json"](a.schema),i=f.reader.model||{},h=i.id,q&&!g(i)?f.modelSet=new r({model:i,create:function(a){f.trigger(t,a)},update:function(a){f.trigger(v,a)},destroy:function(a){f.trigger(w,a)}}):f.modelSet={refresh:m,select:m,sync:m},h?(f.find=d(f.modelSet.find,f.modelSet),f.id=function(a){return h(a)}):f.find=f.at,f.bind([A,x,t,w,v,B],a)},options:{data:[],schema:{},serverSorting:!1,serverPaging:!1,serverFiltering:!1,serverGrouping:!1,serverAggregates:!1,autoSync:!1,sendAllFields:!0,batch:{mode:y}},model:function(a){return this.modelSet.model(a)},_idMap:function(a){var b=this,c=b.id,d,e,f={};if(c)for(d=0,e=a.length;d<e;d++)f[c(a[d])]=d;b._map=f},_createdModels:function(){return this.modelSet.select(q.CREATED,function(a){return a.data})},_updatedModels:function(){var a=this,b=a.options.sendAllFields;return a.modelSet.select(q.UPDATED,function(a){if(b)return a.data;return a.changes()})},_destroyedModels:function(){var a=this,b=a.options;return a.modelSet.select(q.DESTROYED,function(c){var d={};if(b.sendAllFields)return c.data;a.reader.model.id(d,c.id());return d})},sync:function(){var b=this,c,e,f,g=b.options.batch,h,i=b.transport;promises=b._promises=[],c=b._updatedModels(),e=b._createdModels(),f=b._destroyedModels(),g===!1?h=y:(g.mode||y)===y&&(h=z),h?(b._send(e,d(i.create,i),h),b._send(c,d(i.update,i),h),b._send(f,d(i.destroy,i),h)):b._send({created:e,updated:c,destroyed:f},d(i.update,i),z),a.when.apply(null,promises).then(function(){b.trigger(x)})},_syncSuccess:function(a,b){var c=this,d,e,f=c._map,g=c.reader;b=g.parse(b);if(!g.status(b))return c.error({data:a});b=g.data(b),c.modelSet.clear(),c.modelSet.merge(a,b)},_syncError:function(a,b){this.error({data:a})},_send:function(a,b,c){var e=this,f,g,h=e._promises,i=d(e._syncSuccess,e,a),j=d(e._syncError,e,a);if(a.length!=0){if(c===y)for(f=0,g=a.length;f<g;f++)h.push(b({data:a[f],success:i,error:j}));else h.push(b({data:a,success:i,error:j}));return h}},create:function(a,b){return this.modelSet.create(a,b)},read:function(a){var b=this,e=c({take:b.take(),skip:b.skip(),page:b.page(),pageSize:b.pageSize(),sort:b._sort,filter:b._filter,group:b._group,aggregates:b._aggregates},a);b._queueRequest(e,function(){b.trigger(B),b._ranges=[],b.transport.read({data:e,success:d(b.success,b),error:d(b.error,b)})})},_queueRequest:function(a,c){var e=this;e._requestInProgress?e._pending={callback:d(c,e),options:a}:(e._requestInProgress=!0,e._pending=b,c())},_dequeueRequest:function(){var a=this;a._requestInProgress=!1,a._pending&&a._queueRequest(a._pending.options,a._pending.callback)},update:function(a,b){this.modelSet.update(a,b)},destroy:function(a){this.modelSet.destroy(a)},error:function(){this.trigger(A,arguments)},success:function(a){var b=this,c={},d,e=q?b._updatedModels():[],f=b.options.serverGrouping===!0&&b._group&&b._group.length>0;a=b.reader.parse(a),b._total=b.reader.total(a),b._aggregates&&b.options.serverAggregates&&(b._aggregateResult=b.reader.aggregates(a)),f?a=b.reader.groups(a):a=b.reader.data(a);var g=b._skip||0,h=g+a.length;b._ranges.push({start:g,end:h,data:a}),b._ranges.sort(function(a,b){return a.start-b.start}),b._dequeueRequest(),b._process(a)},_process:function(a){var c=this,d={},e,f=c.options.serverGrouping===!0&&c._group&&c._group.length>0;c._data=a,c.modelSet&&c.modelSet.sync(a),c.options.serverPaging!==!0&&(d.skip=c._skip,d.take=c._take||c._pageSize,d.skip===b&&c._page!==b&&c._pageSize!==b&&(d.skip=(c._page-1)*c._pageSize)),c.options.serverSorting!==!0&&(d.sort=c._sort),c.options.serverFiltering!==!0&&(d.filter=c._filter),c.options.serverGrouping!==!0&&(d.group=c._group),c.options.serverAggregates!==!0&&(d.aggregates=c._aggregates,c._aggregateResult=R(a,d)),e=Q(a,d),c._view=e.data,e.total!==b&&!c.options.serverFiltering&&(c._total=e.total),c.modelSet.refresh(a),c.trigger(x)},changes:function(a){return this.modelSet.changes(a)},hasChanges:function(a){return this.modelSet.hasChanges(a)},at:function(a){return this._data[a]},data:function(a){if(a!==b)this._data=a;else return this._data},view:function(){return this._view},query:function(a){var c=this,a=a,d,e=c.options.serverSorting||c.options.serverPaging||c.options.serverFiltering||c.options.serverGrouping||c.options.serverAggregates;a!==b&&(c._pageSize=a.pageSize,c._page=a.page,c._sort=a.sort,c._filter=a.filter,c._group=a.group,c._aggregates=a.aggregates,c._skip=a.skip,c._take=a.take,c._skip===b&&(c._skip=c.skip(),a.skip=c.skip()),c._take===b&&c._pageSize!==b&&(c._take=c._pageSize,a.take=c._take),a.sort&&(c._sort=a.sort=K(a.sort)),a.filter&&(c._filter=a.filter=L(a.filter)),a.group&&(c._group=a.group=N(a.group)),a.aggregates&&(c._aggregates=a.aggregates=M(a.aggregates))),e||c._data===b||c._data.length==0?c.read(a):(c.trigger(B),d=Q(c._data,a),d.total!==b&&!c.options.serverFiltering&&(c._total=d.total),c._view=d.data,c._aggregateResult=R(c._data,a),c.trigger(x))},page:function(a){var c=this,d;if(a!==b)a=Math.max(Math.min(Math.max(a,1),c.totalPages()),1),c.query({page:a,pageSize:c.pageSize(),sort:c.sort(),filter:c.filter(),group:c.group(),aggregates:c.aggregate()});else{d=c.skip();return d!==b?Math.round((d||0)/(c._take||1))+1:b}},pageSize:function(a){var c=this;if(a!==b)c.query({page:c.page(),pageSize:a,sort:c.sort(),filter:c.filter(),group:c.group(),aggregates:c.aggregate()});else return c.take()},sort:function(a){var c=this;if(a!==b)c.query({page:c.page(),pageSize:c.pageSize(),sort:a,filter:c.filter(),group:c.group(),aggregates:c.aggregate()});else return this._sort},filter:function(a){var c=this;if(a!==b)c.query({page:c.page(),pageSize:c.pageSize(),sort:c.sort(),filter:a,group:c.group(),aggregates:c.aggregate()});else return c._filter},group:function(a){var c=this;if(a!==b)c.query({page:c.page(),pageSize:c.pageSize(),sort:c.sort(),filter:c.filter(),group:a,aggregates:c.aggregate()});else return c._group},total:function(){return this._total},aggregate:function(a){var c=this;if(a!==b)c.query({page:c.page(),pageSize:c.pageSize(),sort:c.sort(),filter:a,group:c.group(),aggregates:a});else return c._aggregates},aggregates:function(){return this._aggregateResult},totalPages:function(){var a=this,b=a.pageSize()||a.total();return Math.ceil((a.total()||0)/b)},inRange:function(a,b){var c=this,d=Math.min(a+b,(c.totalPages()-1)*b);if(!c.options.serverPaging&&c.data.length>0)return!0;return c._findRange(a,d).length>0},range:function(a,c){a=a||0;var d=this,e=Math.max(Math.floor(a/c),0)*c,f=Math.min(e+c,d.total()),g;g=d._findRange(a,Math.min(a+c,d.total()));if(g.length){d._skip=e,d._take=c;var h=d.options.serverPaging;try{d.options.serverPaging=!0,d._process(g)}finally{d.options.serverPaging=h}}else c!==b&&(d._rangeExists(e,f)?e<a&&d.prefetch(f,c,function(){d.range(a,c)}):d.prefetch(e,c,function(){a>e&&f<d.total()&&!d._rangeExists(f,Math.min(f+c,d.total()))?d.prefetch(f,c,function(){d.range(a,c)}):d.range(a,c)}))},fetchNextPage:function(){var a=this,b=a.take(),c=Math.max(Math.round(a.skip()/b),0)*b;a.page()<a.totalPages()&&a.prefetch(c+b,b)},fetchPrevPage:function(){var a=this,b=a.take(),c=Math.max(Math.max(Math.floor(a.skip()/b),0)*b-b,0);a.prefetch(c,b)},_findRange:function(a,b){var c=this,d,e=c._ranges,f,g=[],h,i,j,k,d;for(h=0,d=e.length;h<d;h++){f=e[h];if(a>=f.start&&a<=f.end){var l=0;for(i=h;i<d;i++){f=e[i];if(f.data.length&&a+l>=f.start&&l+l<=f.end){j=0,a+l>f.start&&(j=a+l-f.start),k=f.data.length,f.end>b&&(k=k-(f.end-b)),l+=k-j,g=g.concat(f.data.slice(j,k));if(b<=f.end&&l==b-a)return g}}break}}return[]},skip:function(){var a=this;return a._skip||(a._page!==b?(a._page-1)*(a.take()||1):b)},take:function(){var a=this;return a._take||a._pageSize},prefetch:function(a,b,c){var d=this,e=Math.min(a+b,d.total()),f={start:a,end:e,data:[]},g={take:b,skip:a,page:a/b+1,pageSize:b,sort:d._sort,filter:d._filter,group:d._group,aggregates:d._aggregates};d._rangeExists(a,e)?c&&c():(clearTimeout(d._timeout),d._timeout=setTimeout(function(){d._queueRequest(g,function(){d.transport.read({data:g,success:function(b){d._dequeueRequest();var e=!1;for(var g=0,h=d._ranges.length;g<h;g++)if(d._ranges[g].start===a){e=!0,f=d._ranges[g];break}e||d._ranges.push(f),b=d.reader.parse(b),f.data=d.reader.data(b),f.end=f.start+f.data.length,d._ranges.sort(function(a,b){return a.start-b.start}),c&&c()}})})},100))},_rangeExists:function(a,b){var c=this,d=c._ranges,e,f;for(e=0,f=d.length;e<f;e++)if(d[e].start==a&&d[e].end==b)return!0;return!1}});X.create=function(a){a=h(a)?{data:a}:a;var b=a||{},c=b.data,d=b.fields,e=b.table,f=b.select;!c&&d&&!b.transport&&(e?c=Z(e,d):f&&(c=Y(f,d))),b.data=c;return b instanceof X?b:new X(b)},c(!0,n.data,{readers:{json:W},Query:J,DataSource:X,LocalTransport:S,RemoteTransport:T,LocalStorageCache:V,Cache:U,DataReader:W})})(jQuery)