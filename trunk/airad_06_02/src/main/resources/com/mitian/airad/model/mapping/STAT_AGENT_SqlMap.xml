<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="STAT_AGENT" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    <result column="SHAT_ANGEN_ID" property="shatAngenId" jdbcType="INTEGER" />
    <result column="ADVERTISER_ID" property="advertiserId" jdbcType="INTEGER" />
    <result column="ADVERTISER_NAME" property="advertiserName" jdbcType="VARCHAR" />
    <result column="AD_NAME" property="adName" jdbcType="VARCHAR" />
    <result column="AGENT_ID" property="agentId" jdbcType="INTEGER" />
    <result column="AD_ID" property="adId" jdbcType="INTEGER" />
    <result column="SHOW_NUM" property="showNum" jdbcType="INTEGER" />
    <result column="CLICK_NUM" property="clickNum" jdbcType="INTEGER" />
    <result column="OFFER" property="offer" jdbcType="DECIMAL" />
    <result column="ADD_TIME" property="addTime" jdbcType="TIMESTAMP" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <!-- 报表详细 -->
   <select id="queryAngenDetailList" resultClass="com.mitian.airad.model.StatAgent" parameterClass="java.util.Map" >
    select  ADVERTISER_ID advertiserId, ADVERTISER_NAME advertiserName, sum(SHOW_NUM) showNum,
      sum(CLICK_NUM) clickNum, OFFER offer, 
      date_format(ADD_TIME,'%Y-%m-%d') as addTime, CREATE_TIME createTime
    from STAT_AGENT
    where date_format(ADD_TIME,'%Y-%m-%d') between  #startTime# and #endTime# AND JOB_STAT_TYPE=0
       <dynamic>
            <isNotEmpty prepend="and" property="inAgentId">
                AGENT_ID in ($inAgentId$)
            </isNotEmpty>
        </dynamic>
        group by ADVERTISER_ID,ADVERTISER_NAME,ADD_TIME
        <dynamic prepend="order by">
          <isNotEmpty property="descFlag">
                 ADD_TIME DESC
          </isNotEmpty>
          <isNotEmpty property="asceFlag">
                 ADD_TIME ASC
          </isNotEmpty>
        </dynamic>
          <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
  </select>
  <!-- 汇总 -->
  <select id="queryAngenTotalList" resultClass="com.mitian.airad.model.StatAgent" parameterClass="java.util.Map" >
    select sum(SHOW_NUM) showNum,sum(CLICK_NUM) clickNum, sum(OFFER) offer, 
    date_format(ADD_TIME,'%Y-%m-%d') as addTime, CREATE_TIME createTime
    from STAT_AGENT
    where date_format(ADD_TIME,'%Y-%m-%d') between  #startTime# and #endTime# AND JOB_STAT_TYPE=0
       <dynamic>
            <isNotEmpty prepend="and" property="inAgentId">
                AGENT_ID in ($inAgentId$)
            </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d')
        <dynamic prepend="order by">
          <isNotEmpty property="descFlag">
                 date_format(ADD_TIME,'%Y-%m-%d') DESC
          </isNotEmpty>
          <isNotEmpty property="asceFlag">
                 date_format(ADD_TIME,'%Y-%m-%d') ASC
          </isNotEmpty>
        </dynamic>
          <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    select SHAT_ANGEN_ID, ADVERTISER_ID, ADVERTISER_NAME, AD_NAME, AGENT_ID, AD_ID, SHOW_NUM,
      CLICK_NUM, OFFER, ADD_TIME, CREATE_TIME
    from STAT_AGENT
    where SHAT_ANGEN_ID = #shatAngenId:INTEGER#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    delete from STAT_AGENT
    where SHAT_ANGEN_ID = #shatAngenId:INTEGER#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    insert into STAT_AGENT (SHAT_ANGEN_ID, ADVERTISER_ID, ADVERTISER_NAME, AD_NAME, AGENT_ID, AD_ID,
      SHOW_NUM, CLICK_NUM, OFFER, ADD_TIME, CREATE_TIME)
    values (#shatAngenId:INTEGER#, #advertiserId:INTEGER#, #advertiserName:VARCHAR#,
      #adName:VARCHAR#, #agentId:INTEGER#, #adId:INTEGER#, #showNum:INTEGER#, #clickNum:INTEGER#,
      #offer:DECIMAL#, #addTime:TIMESTAMP#, #createTime:TIMESTAMP#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    insert into STAT_AGENT
    <dynamic prepend="(" >
      <isNotNull prepend="," property="shatAngenId" >
        SHAT_ANGEN_ID
      </isNotNull>
      <isNotNull prepend="," property="advertiserId" >
        ADVERTISER_ID
      </isNotNull>
      <isNotNull prepend="," property="advertiserName" >
        ADVERTISER_NAME
      </isNotNull>
      <isNotNull prepend="," property="adName" >
        AD_NAME
      </isNotNull>
      <isNotNull prepend="," property="agentId" >
        AGENT_ID
      </isNotNull>
      <isNotNull prepend="," property="adId" >
        AD_ID
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        SHOW_NUM
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        CLICK_NUM
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME
      </isNotNull>
      <isNotNull prepend="," property="createTime" >
        CREATE_TIME
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        JOB_STAT_TIME
      </isNotNull>
       <isNotNull prepend="," property="jobStatType" >
        JOB_STAT_TYPE
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="shatAngenId" >
        #shatAngenId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="advertiserId" >
        #advertiserId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="advertiserName" >
        #advertiserName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="adName" >
        #adName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentId" >
        #agentId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="adId" >
        #adId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        #showNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        #clickNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="createTime" >
        #createTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        #jobStatTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="jobStatType" >
        #jobStatType:CHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    update STAT_AGENT
    <dynamic prepend="set" >
      <isNotNull prepend="," property="advertiserId" >
        ADVERTISER_ID = #advertiserId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="advertiserName" >
        ADVERTISER_NAME = #advertiserName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="adName" >
        AD_NAME = #adName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentId" >
        AGENT_ID = #agentId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="adId" >
        AD_ID = #adId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        SHOW_NUM = #showNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        CLICK_NUM = #clickNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER = #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME = #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="createTime" >
        CREATE_TIME = #createTime:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where SHAT_ANGEN_ID = #shatAngenId:INTEGER#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.StatAgent" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 14:17:51 CST 2011.
    -->
    update STAT_AGENT
    set ADVERTISER_ID = #advertiserId:INTEGER#,
      ADVERTISER_NAME = #advertiserName:VARCHAR#,
      AD_NAME = #adName:VARCHAR#,
      AGENT_ID = #agentId:INTEGER#,
      AD_ID = #adId:INTEGER#,
      SHOW_NUM = #showNum:INTEGER#,
      CLICK_NUM = #clickNum:INTEGER#,
      OFFER = #offer:DECIMAL#,
      ADD_TIME = #addTime:TIMESTAMP#,
      CREATE_TIME = #createTime:TIMESTAMP#
    where SHAT_ANGEN_ID = #shatAngenId:INTEGER#
  </update>
</sqlMap>