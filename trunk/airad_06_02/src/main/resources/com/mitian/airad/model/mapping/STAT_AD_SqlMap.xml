<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="STAT_AD">
    <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        <result column="SHAT_AD_ID" property="shatAdId" jdbcType="INTEGER" />
        <result column="AD_ID" property="adId" jdbcType="INTEGER" />
        <result column="AD_NAME" property="adName" jdbcType="VARCHAR" />
        <result column="AD_GROUP_ID" property="adGroupId" jdbcType="INTEGER" />
        <result column="AD_GROUP_NAME" property="adGroupName" jdbcType="VARCHAR" />
        <result column="CAMPAIGN_ID" property="campaignId" jdbcType="INTEGER" />
        <result column="CAMPAIGN_NAME" property="campaignName" jdbcType="VARCHAR" />
        <result column="ADVERTISER_ID" property="advertiserId" jdbcType="INTEGER" />
        <result column="SHOW_NUM" property="showNum" jdbcType="INTEGER" />
        <result column="CLICK_NUM" property="clickNum" jdbcType="INTEGER" />
        <result column="SHOW_MONEY" property="showMoney" jdbcType="DECIMAL" />
        <result column="CLICK_MONEY" property="clickMoney" jdbcType="DECIMAL" />
        <result column="ADD_TIME" property="addTime" jdbcType="TIMESTAMP" />
        <result column="SHOW_TYPE" property="showType" jdbcType="CHAR" />
        <result column="DEL_FLAG" property="delFlag" jdbcType="CHAR" />
        <result column="CLICK_RATE" property="clickRate" jdbcType="DECIMAL" />        
    </resultMap>
    <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        select SHAT_AD_ID, AD_ID, AD_NAME, AD_GROUP_ID, AD_GROUP_NAME, CAMPAIGN_ID, CAMPAIGN_NAME, ADVERTISER_ID,
        SHOW_NUM, CLICK_NUM, SHOW_MONEY, CLICK_MONEY, ADD_TIME, SHOW_TYPE,DEL_FLAG from STAT_AD where SHAT_AD_ID =
        #shatAdId:INTEGER#
    </select>
    <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        delete from STAT_AD where SHAT_AD_ID = #shatAdId:INTEGER#
    </delete>
    <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        insert into STAT_AD (SHAT_AD_ID, AD_ID, AD_NAME, AD_GROUP_ID, AD_GROUP_NAME, CAMPAIGN_ID, CAMPAIGN_NAME,
        ADVERTISER_ID, SHOW_NUM, CLICK_NUM, SHOW_MONEY, CLICK_MONEY, ADD_TIME, SHOW_TYPE,DEL_FLAG) values
        (#shatAdId:INTEGER#, #adId:INTEGER#, #adName:VARCHAR#, #adGroupId:INTEGER#, #adGroupName:VARCHAR#,
        #campaignId:INTEGER#, #campaignName:VARCHAR#, #advertiserId:INTEGER#, #showNum:INTEGER#, #clickNum:INTEGER#,
        #showMoney:DECIMAL#, #clickMoney:DECIMAL#, #addTime:TIMESTAMP#, #showType:CHAR#, #delFlag:CHAR#)
    </insert>
    <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        insert into STAT_AD
        <dynamic prepend="(">
            <isNotNull prepend="," property="shatAdId"> SHAT_AD_ID</isNotNull>
            <isNotNull prepend="," property="adId"> AD_ID</isNotNull>
            <isNotNull prepend="," property="adName"> AD_NAME</isNotNull>
            <isNotNull prepend="," property="adGroupId"> AD_GROUP_ID</isNotNull>
            <isNotNull prepend="," property="adGroupName"> AD_GROUP_NAME</isNotNull>
            <isNotNull prepend="," property="campaignId"> CAMPAIGN_ID</isNotNull>
            <isNotNull prepend="," property="campaignName"> CAMPAIGN_NAME</isNotNull>
            <isNotNull prepend="," property="advertiserId"> ADVERTISER_ID</isNotNull>
            <isNotNull prepend="," property="showNum"> SHOW_NUM</isNotNull>
            <isNotNull prepend="," property="clickNum"> CLICK_NUM</isNotNull>
            <isNotNull prepend="," property="showMoney"> SHOW_MONEY</isNotNull>
            <isNotNull prepend="," property="clickMoney"> CLICK_MONEY</isNotNull>
            <isNotNull prepend="," property="addTime"> ADD_TIME</isNotNull>
            <isNotNull prepend="," property="showType"> SHOW_TYPE</isNotNull>
            <isNotNull prepend="," property="jobStatTime"> JOB_STAT_TIME</isNotNull>
            <isNotNull prepend="," property="jobStatType"> JOB_STAT_TYPE</isNotNull>
            <isNotNull prepend="," property="delFlag"> DEL_FLAG</isNotNull>
            )
        </dynamic>
        values
        <dynamic prepend="(">
            <isNotNull prepend="," property="shatAdId"> #shatAdId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="adId"> #adId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="adName"> #adName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="adGroupId"> #adGroupId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="adGroupName"> #adGroupName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="campaignId"> #campaignId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="campaignName"> #campaignName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="advertiserId"> #advertiserId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="showNum"> #showNum:INTEGER#</isNotNull>
            <isNotNull prepend="," property="clickNum"> #clickNum:INTEGER#</isNotNull>
            <isNotNull prepend="," property="showMoney"> #showMoney:DECIMAL#</isNotNull>
            <isNotNull prepend="," property="clickMoney"> #clickMoney:DECIMAL#</isNotNull>
            <isNotNull prepend="," property="addTime"> #addTime:TIMESTAMP#</isNotNull>
            <isNotNull prepend="," property="showType"> #showType:CHAR#</isNotNull>
            <isNotNull prepend="," property="jobStatTime"> #jobStatTime:TIMESTAMP#</isNotNull>
            <isNotNull prepend="," property="jobStatType"> #jobStatType:CHAR#</isNotNull>
            <isNotNull prepend="," property="delFlag"> #delFlag:CHAR#</isNotNull>
            )
        </dynamic>
    </insert>
    <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        update STAT_AD
        <dynamic prepend="set">
            <isNotNull prepend="," property="adId"> AD_ID = #adId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="adName"> AD_NAME = #adName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="adGroupId"> AD_GROUP_ID = #adGroupId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="adGroupName"> AD_GROUP_NAME = #adGroupName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="campaignId"> CAMPAIGN_ID = #campaignId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="campaignName"> CAMPAIGN_NAME = #campaignName:VARCHAR#</isNotNull>
            <isNotNull prepend="," property="advertiserId"> ADVERTISER_ID = #advertiserId:INTEGER#</isNotNull>
            <isNotNull prepend="," property="showNum"> SHOW_NUM = #showNum:INTEGER#</isNotNull>
            <isNotNull prepend="," property="clickNum"> CLICK_NUM = #clickNum:INTEGER#</isNotNull>
            <isNotNull prepend="," property="showMoney"> SHOW_MONEY = #showMoney:DECIMAL#</isNotNull>
            <isNotNull prepend="," property="clickMoney"> CLICK_MONEY = #clickMoney:DECIMAL#</isNotNull>
            <isNotNull prepend="," property="addTime"> ADD_TIME = #addTime:TIMESTAMP#</isNotNull>
            <isNotNull prepend="," property="showType"> SHOW_TYPE = #showType:CHAR#</isNotNull>
        </dynamic>
        where SHAT_AD_ID = #shatAdId:INTEGER#
    </update>
    <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.StatAd">
        <!--
            WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify. This element was
            generated on Thu Mar 10 10:17:28 CST 2011.
        -->
        update STAT_AD set AD_ID = #adId:INTEGER#, AD_NAME = #adName:VARCHAR#, AD_GROUP_ID = #adGroupId:INTEGER#,
        AD_GROUP_NAME = #adGroupName:VARCHAR#, CAMPAIGN_ID = #campaignId:INTEGER#, CAMPAIGN_NAME =
        #campaignName:VARCHAR#, ADVERTISER_ID = #advertiserId:INTEGER#, SHOW_NUM = #showNum:INTEGER#, CLICK_NUM =
        #clickNum:INTEGER#, SHOW_MONEY = #showMoney:DECIMAL#, CLICK_MONEY = #clickMoney:DECIMAL#, ADD_TIME =
        #addTime:TIMESTAMP#, SHOW_TYPE = #showType:CHAR# where SHAT_AD_ID = #shatAdId:INTEGER# 
    </update>
    <!--广告统计(详细)-->
    <select id="querybyadDetailList" resultMap="ibatorgenerated_BaseResultMap" parameterClass="java.util.Map">
        select SHAT_AD_ID, AD_ID, AD_NAME, AD_GROUP_ID, AD_GROUP_NAME, CAMPAIGN_ID, CAMPAIGN_NAME, ADVERTISER_ID,
        SHOW_NUM, CLICK_NUM, SHOW_MONEY, CLICK_MONEY, date_format(ADD_TIME,'%Y-%m-%d') as ADD_TIME, SHOW_TYPE,DEL_FLAG
        ,IFNULL(CLICK_NUM/SHOW_NUM,0) CLICK_RATE from STAT_AD where date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime# AND JOB_STAT_TYPE=0
        <dynamic>
            <isNotNull prepend="and" property="inAdId"> AD_ID in ($inAdId$)</isNotNull>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC ,AD_ID DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC,AD_ID ASC</isNotEmpty>
        </dynamic>
        <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!--广告统计(汇总)-->
    <select id="querybyadTotalList" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select sum(SHOW_NUM) showNum, sum(CLICK_NUM) clickNum,sum(SHOW_MONEY) showMoney, sum(CLICK_MONEY) clickMoney,
        date_format(ADD_TIME,'%Y-%m-%d') as addTime, SHOW_TYPE showType ,sum(CLICK_NUM)/sum(SHOW_NUM) clickRate from STAT_AD where
        date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime#
        AND JOB_STAT_TYPE=0 
        <dynamic>
            <isNotNull prepend="and" property="inAdId"> AD_ID in ($inAdId$)</isNotNull>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d')
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC</isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!-- 广告组统计(汇总)-->
    <select id="querybyadGroupTotalList" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select sum(SHOW_NUM) showNum, sum(CLICK_NUM) clickNum,sum(SHOW_MONEY) showMoney, sum(CLICK_MONEY) clickMoney,
        date_format(ADD_TIME,'%Y-%m-%d') as addTime, SHOW_TYPE showType ,sum(CLICK_NUM)/sum(SHOW_NUM) clickRate from STAT_AD where
        date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime#
        AND JOB_STAT_TYPE=0
        <dynamic>
            <isNotNull prepend="and" property="inAdGroupId"> AD_GROUP_ID in ($inAdGroupId$)</isNotNull>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d')
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC</isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!-- 广告组统计(详细)-->
    <select id="querybyadGroupDetailList" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select AD_GROUP_ID adGroupId, AD_GROUP_NAME adGroupName, sum(SHOW_NUM) showNum, sum(CLICK_NUM)
        clickNum,sum(SHOW_MONEY) showMoney, sum(CLICK_MONEY) clickMoney, date_format(ADD_TIME,'%Y-%m-%d') as addTime,
        SHOW_TYPE showType ,sum(CLICK_NUM)/sum(SHOW_NUM) clickRate from STAT_AD where date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime#
        AND JOB_STAT_TYPE=0
        <dynamic>
            <isNotNull prepend="and" property="inAdGroupId"> AD_GROUP_ID in ($inAdGroupId$)</isNotNull>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d'),AD_GROUP_NAME,AD_GROUP_ID
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC,AD_GROUP_ID DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC,AD_GROUP_ID ASC</isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!-- 活动统计(详细)-->
    <select id="queryCampaignDetailList" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select CAMPAIGN_ID campaignId, CAMPAIGN_NAME campaignName, sum(SHOW_NUM) showNum, sum(CLICK_NUM)
        clickNum,sum(SHOW_MONEY) showMoney, sum(CLICK_MONEY) clickMoney, date_format(ADD_TIME,'%Y-%m-%d') as addTime,
        SHOW_TYPE showType ,sum(CLICK_NUM)/sum(SHOW_NUM) clickRate from STAT_AD where date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime#
        AND JOB_STAT_TYPE=0
        <dynamic>
            <isNotNull prepend="and" property="inCampaignId"> CAMPAIGN_ID in ($inCampaignId$)</isNotNull>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d'),CAMPAIGN_NAME,CAMPAIGN_ID
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC , CAMPAIGN_ID DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC, CAMPAIGN_ID ASC</isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!-- 活动统计(汇总)-->
    <select id="queryCampaignTotalList" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select sum(SHOW_NUM) showNum, sum(CLICK_NUM) clickNum,sum(SHOW_MONEY) showMoney, sum(CLICK_MONEY) clickMoney,
        date_format(ADD_TIME,'%Y-%m-%d') as addTime , SHOW_TYPE showType ,sum(CLICK_NUM)/sum(SHOW_NUM) clickRate from STAT_AD where
        date_format(ADD_TIME,'%Y-%m-%d') between #startTime# and #endTime# AND JOB_STAT_TYPE=0
        <dynamic>
            <isNotEmpty prepend="and" property="inCampaignId"> CAMPAIGN_ID in ($inCampaignId$)</isNotEmpty>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d')
        <dynamic prepend="order by">
            <isNotEmpty property="descFlag"> date_format(ADD_TIME,'%Y-%m-%d') DESC</isNotEmpty>
            <isNotEmpty property="asceFlag"> date_format(ADD_TIME,'%Y-%m-%d') ASC</isNotEmpty>
        </dynamic>
        <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
    <!-- 某个用户的广告的总展示次数 -->
    <select id="queryAdShwoByMemberId" resultClass="com.mitian.airad.model.StatAd" parameterClass="java.util.Map">
        select sum(SHOW_NUM) showNum from STAT_AD where JOB_STAT_TYPE=0
        <dynamic>
            <isNotEmpty prepend="and" property="memberId"> ADVERTISER_ID=#memberId# </isNotEmpty>
        </dynamic>
    </select>
</sqlMap>