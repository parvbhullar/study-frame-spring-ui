<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="STAT_WITHDRAW" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    <result column="STAT_DRAW_ID" property="statDrawId" jdbcType="INTEGER" />
    <result column="MEMBER_ID" property="memberId" jdbcType="INTEGER" />
    <result column="DRAW_MONEY_SERIAL_ID" property="drawMoneySerialId" jdbcType="VARCHAR" />
    <result column="DRAW_MONEY" property="drawMoney" jdbcType="DECIMAL" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIONPAY_ID" property="unionpayId" jdbcType="VARCHAR" />
    <result column="DRAW_BANK_NUM" property="drawBankNum" jdbcType="VARCHAR" />
    <result column="DRAW_NAME" property="drawName" jdbcType="VARCHAR" />
    <result column="ADD_TIME" property="addTime" jdbcType="TIMESTAMP" />
    <result column="JOB_STAT_TIME" property="jobStatTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMap_Extend" class="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    <result column="MEMBER_ID" property="memberId" jdbcType="INTEGER" />
    <result column="DRAW_MONEY_SERIAL_ID" property="drawMoneySerialId" jdbcType="VARCHAR" />
    <result column="DRAW_MONEY" property="drawMoney" jdbcType="DECIMAL" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIONPAY_ID" property="unionpayId" jdbcType="VARCHAR" />
    <result column="DRAW_BANK_NUM" property="drawBankNum" jdbcType="VARCHAR" />
    <result column="DRAW_NAME" property="drawName" jdbcType="VARCHAR" />
  </resultMap>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    select STAT_DRAW_ID, MEMBER_ID, DRAW_MONEY_SERIAL_ID, DRAW_MONEY, STATUS, UNIONPAY_ID,
      DRAW_BANK_NUM, DRAW_NAME, ADD_TIME, JOB_STAT_TIME
    from STAT_WITHDRAW
    where STAT_DRAW_ID = #statDrawId:INTEGER#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    delete from STAT_WITHDRAW
    where STAT_DRAW_ID = #statDrawId:INTEGER#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    insert into STAT_WITHDRAW (STAT_DRAW_ID, MEMBER_ID, DRAW_MONEY_SERIAL_ID, DRAW_MONEY, STATUS,
      UNIONPAY_ID, DRAW_BANK_NUM, DRAW_NAME, ADD_TIME, JOB_STAT_TIME)
    values (#statDrawId:INTEGER#, #memberId:INTEGER#, #drawMoneySerialId:VARCHAR#,
      #drawMoney:DECIMAL#, #status:CHAR#, #unionpayId:VARCHAR#, #drawBankNum:VARCHAR#,
      #drawName:VARCHAR#, #addTime:TIMESTAMP#, #jobStatTime:TIMESTAMP#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    insert into STAT_WITHDRAW
    <dynamic prepend="(" >
      <isNotNull prepend="," property="statDrawId" >
        STAT_DRAW_ID
      </isNotNull>
      <isNotNull prepend="," property="memberId" >
        MEMBER_ID
      </isNotNull>
      <isNotNull prepend="," property="drawMoneySerialId" >
        DRAW_MONEY_SERIAL_ID
      </isNotNull>
      <isNotNull prepend="," property="drawMoney" >
        DRAW_MONEY
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS
      </isNotNull>
      <isNotNull prepend="," property="unionpayId" >
        UNIONPAY_ID
      </isNotNull>
      <isNotNull prepend="," property="drawBankNum" >
        DRAW_BANK_NUM
      </isNotNull>
      <isNotNull prepend="," property="drawName" >
        DRAW_NAME
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        JOB_STAT_TIME
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="statDrawId" >
        #statDrawId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="memberId" >
        #memberId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="drawMoneySerialId" >
        #drawMoneySerialId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawMoney" >
        #drawMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        #status:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="unionpayId" >
        #unionpayId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawBankNum" >
        #drawBankNum:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawName" >
        #drawName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        #jobStatTime:TIMESTAMP#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    update STAT_WITHDRAW
    <dynamic prepend="set" >
      <isNotNull prepend="," property="memberId" >
        MEMBER_ID = #memberId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="drawMoneySerialId" >
        DRAW_MONEY_SERIAL_ID = #drawMoneySerialId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawMoney" >
        DRAW_MONEY = #drawMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="unionpayId" >
        UNIONPAY_ID = #unionpayId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawBankNum" >
        DRAW_BANK_NUM = #drawBankNum:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="drawName" >
        DRAW_NAME = #drawName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME = #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        JOB_STAT_TIME = #jobStatTime:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where STAT_DRAW_ID = #statDrawId:INTEGER#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.StatWithdraw" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sat Apr 02 15:30:14 CST 2011.
    -->
    update STAT_WITHDRAW
    set MEMBER_ID = #memberId:INTEGER#,
      DRAW_MONEY_SERIAL_ID = #drawMoneySerialId:VARCHAR#,
      DRAW_MONEY = #drawMoney:DECIMAL#,
      STATUS = #status:CHAR#,
      UNIONPAY_ID = #unionpayId:VARCHAR#,
      DRAW_BANK_NUM = #drawBankNum:VARCHAR#,
      DRAW_NAME = #drawName:VARCHAR#,
      ADD_TIME = #addTime:TIMESTAMP#,
      JOB_STAT_TIME = #jobStatTime:TIMESTAMP#
    where STAT_DRAW_ID = #statDrawId:INTEGER#
  </update>
  <!-- 提现统计 -->
  <select id="STAT_ACCOUNT_DRAW" parameterClass="com.mitian.airad.model.StatWithdraw" resultMap="ibatorgenerated_BaseResultMap_Extend">
       
      SELECT 
          A.DRAW_MONEY_SERIAL_ID 
          ,A.MEMBER_ID 
          ,IFNULL(SUM(A.DRAW_MONEY),0) DRAW_MONEY
          ,A.STATUS 
          ,B.OPENING_BANK DRAW_BANK_NUM 
          ,B.REAL_NAME DRAW_NAME 
          ,B.UNIONPAY_ID 
     FROM CORE_WITHDRAW A
      LEFT JOIN CORE_ACCOUNT_INFO B
      ON A.MEMBER_ID = B.MEMBER_ID
      where   DATE_FORMAT(DRAW_TIME,'%Y-%m')<![CDATA[ = #jobTime#]]>
      GROUP BY A.MEMBER_ID,STATUS 
</select>
 <select id="selectAllStatistic" parameterClass="java.util.Map" resultMap="ibatorgenerated_BaseResultMap">
      select STAT_DRAW_ID, MEMBER_ID, DRAW_MONEY_SERIAL_ID, DRAW_MONEY, STATUS, UNIONPAY_ID,
      DRAW_BANK_NUM, DRAW_NAME, ADD_TIME, JOB_STAT_TIME
    from STAT_WITHDRAW
  </select>
   <select id="selectCountStatistic" resultClass="java.lang.Integer">
    select count(*)
    from STAT_WITHDRAW_MONTH
  </select>
</sqlMap>