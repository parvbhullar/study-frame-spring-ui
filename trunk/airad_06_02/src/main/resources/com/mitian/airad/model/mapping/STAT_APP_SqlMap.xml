<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="STAT_APP" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    <result column="SHAT_APP_ID" property="shatAppId" jdbcType="INTEGER" />
    <result column="APP_ID" property="appId" jdbcType="INTEGER" />
    <result column="APP_CODE" property="appCode" jdbcType="VARCHAR" />
    <result column="APP_NAME" property="appName" jdbcType="VARCHAR" />
    <result column="SHOW_NUM" property="showNum" jdbcType="INTEGER" />
    <result column="CLICK_NUM" property="clickNum" jdbcType="INTEGER" />
    <result column="MAX_NUM" property="maxNum" jdbcType="INTEGER" />
    <result column="AD_NUM" property="adNum" jdbcType="INTEGER" />
    <result column="OFFER" property="offer" jdbcType="DECIMAL" />
    <result column="ADD_TIME" property="addTime" jdbcType="TIMESTAMP" />
    <result column="CLICK_RATE" property="clickRate" jdbcType="DECIMAL" />
    <result column="PUT_RATE" property="putRate" jdbcType="DECIMAL" />
  </resultMap>
  <!-- 应用程序（详细）0按天1按月-->
    <select id="queryDetailList" parameterClass="java.util.Map" resultMap="ibatorgenerated_BaseResultMap">
         select SHAT_APP_ID, APP_ID, APP_CODE, APP_NAME, SHOW_NUM, CLICK_NUM, MAX_NUM, AD_NUM, OFFER,
         ADD_TIME, CLICK_NUM/SHOW_NUM CLICK_RATE,  SHOW_NUM/MAX_NUM PUT_RATE
         from STAT_APP where MEMBER_ID=#memberId# 
    <![CDATA[
         and ADD_TIME>=#startTime# and  ADD_TIME<=#endTime# AND JOB_STAT_TYPE=0
        ]]>
        <dynamic>
            <isNotEmpty prepend="and" property="inAppId">
                APP_ID in ($inAppId$)
            </isNotEmpty>
        </dynamic>
        <dynamic prepend="order by">
          <isNotEmpty property="descFlag">
                 ADD_TIME DESC ,APP_ID DESC
          </isNotEmpty>
          <isNotEmpty property="asceFlag">
                 ADD_TIME ASC ,APP_ID ASC
          </isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>

  <!-- 应用程序（汇总） -->
   <select id="queryTotalList" parameterClass="java.util.Map" resultClass="com.mitian.airad.model.StatApp">
         select APP_ID appId, APP_CODE appCode, sum(SHOW_NUM) showNum, sum(CLICK_NUM) clickNum,sum(MAX_NUM) maxNum, 
         sum(AD_NUM) adNum, sum(OFFER) offer,
         IFNULL(sum(CLICK_NUM)/sum(SHOW_NUM),0) clickRate,
         IFNULL(sum(SHOW_NUM)/sum(MAX_NUM),0) putRate,
         date_format(ADD_TIME,'%Y-%m-%d') as addTime
             <![CDATA[
         from STAT_APP where ADD_TIME>=#startTime# and  ADD_TIME<=#endTime# AND JOB_STAT_TYPE=0
        ]]>
        <dynamic>
            <isNotEmpty prepend="and" property="inAppId">
                APP_ID in ($inAppId$)
            </isNotEmpty>
        </dynamic>
        group by date_format(ADD_TIME,'%Y-%m-%d')
        <dynamic prepend="order by">
          <isNotEmpty property="descFlag">
                 date_format(ADD_TIME,'%Y-%m-%d') DESC
          </isNotEmpty>
          <isNotEmpty property="asceFlag">
                 date_format(ADD_TIME,'%Y-%m-%d') ASC
          </isNotEmpty>
        </dynamic>
         <dynamic>
         <isNotEmpty property="fromRecord">
            limit $fromRecord$,$pageSize$
         </isNotEmpty>
        </dynamic>
    </select>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    select SHAT_APP_ID, APP_ID, APP_CODE, APP_NAME, SHOW_NUM, CLICK_NUM, MAX_NUM, AD_NUM, OFFER,
      ADD_TIME, CLICK_RATE, PUT_RATE
    from STAT_APP
    where SHAT_APP_ID = #shatAppId:INTEGER#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    delete from STAT_APP
    where SHAT_APP_ID = #shatAppId:INTEGER#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    insert into STAT_APP (SHAT_APP_ID, APP_ID, APP_CODE, APP_NAME, SHOW_NUM, CLICK_NUM, MAX_NUM,
      AD_NUM, OFFER, ADD_TIME, CLICK_RATE, PUT_RATE)
    values (#shatAppId:INTEGER#, #appId:INTEGER#, #appCode:VARCHAR#, #appName:VARCHAR#,
      #showNum:INTEGER#, #clickNum:INTEGER#, #maxNum:INTEGER#, #adNum:INTEGER#, #offer:DECIMAL#,
      #addTime:TIMESTAMP#, #clickRate:DECIMAL#, #putRate:DECIMAL#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    insert into STAT_APP
    <dynamic prepend="(" >
      <isNotNull prepend="," property="shatAppId" >
        SHAT_APP_ID
      </isNotNull>
      <isNotNull prepend="," property="appId" >
        APP_ID
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        APP_CODE
      </isNotNull>
      <isNotNull prepend="," property="appName" >
        APP_NAME
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        SHOW_NUM
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        CLICK_NUM
      </isNotNull>
      <isNotNull prepend="," property="maxNum" >
        MAX_NUM
      </isNotNull>
      <isNotNull prepend="," property="adNum" >
        AD_NUM
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME
      </isNotNull>
      <isNotNull prepend="," property="clickRate" >
        CLICK_RATE
      </isNotNull>
      <isNotNull prepend="," property="putRate" >
        PUT_RATE
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        JOB_STAT_TIME
      </isNotNull>
       <isNotNull prepend="," property="jobStatType" >
        JOB_STAT_TYPE
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="shatAppId" >
        #shatAppId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="appId" >
        #appId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        #appCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appName" >
        #appName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        #showNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        #clickNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="maxNum" >
        #maxNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="adNum" >
        #adNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="clickRate" >
        #clickRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="putRate" >
        #putRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="jobStatTime" >
        #jobStatTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="jobStatType" >
        #jobStatType:CHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    update STAT_APP
    <dynamic prepend="set" >
      <isNotNull prepend="," property="appId" >
        APP_ID = #appId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="appCode" >
        APP_CODE = #appCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appName" >
        APP_NAME = #appName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="showNum" >
        SHOW_NUM = #showNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="clickNum" >
        CLICK_NUM = #clickNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="maxNum" >
        MAX_NUM = #maxNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="adNum" >
        AD_NUM = #adNum:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="offer" >
        OFFER = #offer:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="addTime" >
        ADD_TIME = #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="clickRate" >
        CLICK_RATE = #clickRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="putRate" >
        PUT_RATE = #putRate:DECIMAL#
      </isNotNull>
    </dynamic>
    where SHAT_APP_ID = #shatAppId:INTEGER#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.mitian.airad.model.StatApp" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Mar 10 10:17:28 CST 2011.
    -->
    update STAT_APP
    set APP_ID = #appId:INTEGER#,
      APP_CODE = #appCode:VARCHAR#,
      APP_NAME = #appName:VARCHAR#,
      SHOW_NUM = #showNum:INTEGER#,
      CLICK_NUM = #clickNum:INTEGER#,
      MAX_NUM = #maxNum:INTEGER#,
      AD_NUM = #adNum:INTEGER#,
      OFFER = #offer:DECIMAL#,
      ADD_TIME = #addTime:TIMESTAMP#,
      CLICK_RATE = #clickRate:DECIMAL#,
      PUT_RATE = #putRate:DECIMAL#
    where SHAT_APP_ID = #shatAppId:INTEGER#
  </update>
</sqlMap>